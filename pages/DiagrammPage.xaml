<Page x:Class="WPF_Payment_Project.Pages.DiagrammPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:wf="clr-namespace:System.Windows.Forms.Integration;assembly=WindowsFormsIntegration"
      xmlns:charts="clr-namespace:System.Windows.Forms.DataVisualization.Charting;assembly=System.Windows.Forms.DataVisualization"
      Title="Диаграммы и экспорт">
    <Grid Margin="32">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <TextBlock Text="Диаграммы и отчеты" 
                   Grid.Row="0"
                   FontSize="28" 
                   FontWeight="Bold" 
                   HorizontalAlignment="Center"
                   Margin="0,0,0,24"/>

        <Border Grid.Row="1" 
                Background="{DynamicResource SurfaceBrush}"
                CornerRadius="12"
                Padding="20"
                Margin="0,0,0,24">
            <WrapPanel Orientation="Horizontal" HorizontalAlignment="Center">
                <StackPanel Orientation="Horizontal" Margin="0,0,16,0">
                    <TextBlock Text="Пользователь:" 
                               VerticalAlignment="Center" 
                               FontSize="14"
                               Margin="0,0,8,0"/>
                    <ComboBox x:Name="CmbUser" 
                              Width="200" 
                              Height="40"
                              DisplayMemberPath="FIO" 
                              SelectionChanged="UpdateChart"/>
                </StackPanel>
                
                <StackPanel Orientation="Horizontal" Margin="0,0,16,0">
                    <TextBlock Text="Тип диаграммы:" 
                               VerticalAlignment="Center" 
                               FontSize="14"
                               Margin="0,0,8,0"/>
                    <ComboBox x:Name="CmbDiagram" 
                              Width="150" 
                              Height="40"
                              SelectionChanged="UpdateChart"/>
                </StackPanel>
                
                <Button x:Name="BtnExportWord" 
                        Content="Экспорт в Word" 
                        Height="40"
                        Padding="16,0"
                        Margin="0,0,8,0"
                        Click="BtnExportWord_Click"/>
                <Button x:Name="BtnExportExcel" 
                        Content="Экспорт в Excel" 
                        Height="40"
                        Padding="16,0"
                        Click="BtnExportExcel_Click"/>
            </WrapPanel>
        </Border>

        <Border Grid.Row="2"
                Background="{DynamicResource SurfaceBrush}"
                CornerRadius="12"
                Padding="16">
            <wf:WindowsFormsHost>
                <charts:Chart x:Name="ChartPayments">
                    <charts:Chart.Legends>
                        <charts:Legend/>
                    </charts:Chart.Legends>
                </charts:Chart>
            </wf:WindowsFormsHost>
        </Border>
    </Grid>
</Page>
